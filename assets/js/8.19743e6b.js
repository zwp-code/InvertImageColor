(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{406:function(s,t,a){"use strict";a.r(t);var e=a(56),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker学习"}},[s._v("#")]),s._v(" Docker学习")]),s._v(" "),a("h2",{attrs:{id:"_1-docker概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker概述"}},[s._v("#")]),s._v(" 1.Docker概述")]),s._v(" "),a("h3",{attrs:{id:"基本介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本介绍"}},[s._v("#")]),s._v(" 基本介绍")]),s._v(" "),a("p",[s._v("Docker 是一个开源的应用容器引擎，基于 Go 语言 并遵从 Apache2.0 协议开源。")]),s._v(" "),a("p",[s._v("Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。")]),s._v(" "),a("p",[s._v("容器是完全使用沙箱机制，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能开销极低。")]),s._v(" "),a("p",[s._v("Docker 从 17.03 版本之后分为 CE（Community Edition: 社区版） 和 EE（Enterprise Edition: 企业版），我们用社区版就可以了。官网：https://docs.docker.com/")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/150ddf9de240442396c4da2146ef2690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX1lhbk1pbmdYaW4=,size_16,color_FFFFFF,t_70",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用场景"}},[s._v("#")]),s._v(" 应用场景")]),s._v(" "),a("ul",[a("li",[s._v("Web 应用的自动化打包和发布。")]),s._v(" "),a("li",[s._v("自动化测试和持续集成、发布。")]),s._v(" "),a("li",[s._v("在服务型环境中部署和调整数据库或其他的后台应用。")]),s._v(" "),a("li",[s._v("从头编译或者扩展现有的 OpenShift 或 Cloud Foundry 平台来搭建自己的 PaaS 环境")])]),s._v(" "),a("h3",{attrs:{id:"docker的优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker的优势"}},[s._v("#")]),s._v(" Docker的优势")]),s._v(" "),a("p",[s._v("Docker 是一个用于开发，交付和运行应用程序的开放平台。Docker 使您能够将应用程序与基础架构分开，从而可以快速交付软件。借助 Docker，您可以与管理应用程序相同的方式来管理基础架构。通过利用 Docker 的方法来快速交付，测试和部署代码，您可以大大减少编写代码和在生产环境中运行代码之间的延迟。")]),s._v(" "),a("p",[s._v("1、快速，一致地交付您的应用程序。Docker 允许开发人员使用您提供的应用程序或服务的本地容器在标准化环境中工作，从而简化了开发的生命周期。")]),s._v(" "),a("p",[s._v("容器非常适合持续集成和持续交付（CI / CD）工作流程，请考虑以下示例方案：")]),s._v(" "),a("p",[s._v("您的开发人员在本地编写代码，并使用 Docker 容器与同事共享他们的工作。\n他们使用 Docker 将其应用程序推送到测试环境中，并执行自动或手动测试。\n当开发人员发现错误时，他们可以在开发环境中对其进行修复，然后将其重新部署到测试环境中，以进行测试和验证。\n测试完成后，将修补程序推送给生产环境，就像将更新的镜像推送到生产环境一样简单。\n2、响应式部署和扩展\nDocker 是基于容器的平台，允许高度可移植的工作负载。Docker 容器可以在开发人员的本机上，数据中心的物理或虚拟机上，云服务上或混合环境中运行。")]),s._v(" "),a("p",[s._v("Docker 的可移植性和轻量级的特性，还可以使您轻松地完成动态管理的工作负担，并根据业务需求指示，实时扩展或拆除应用程序和服务。")]),s._v(" "),a("p",[s._v("3、在同一硬件上运行更多工作负载\nDocker 轻巧快速。它为基于虚拟机管理程序的虚拟机提供了可行、经济、高效的替代方案，因此您可以利用更多的计算能力来实现业务目标。Docker 非常适合于高密度环境以及中小型部署，而您可以用更少的资源做更多的事情。")]),s._v(" "),a("h2",{attrs:{id:"_2-虚拟化技术和容器化技术"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-虚拟化技术和容器化技术"}},[s._v("#")]),s._v(" 2.虚拟化技术和容器化技术")]),s._v(" "),a("p",[s._v("虚拟化技术特点（缺点）："),a("strong",[s._v("1.资源占用多 2.冗余步骤多 3.启动很慢")])]),s._v(" "),a("p",[s._v("容器化技术：容器化技术不是模拟的一个完整的操作系统")]),s._v(" "),a("p",[s._v("比较Docker和虚拟机的不同：\n1.传统虚拟机，虚拟出硬件，运行一个完整的操作系统，然后在这个系统上安装和运行软件。")]),s._v(" "),a("p",[s._v("2.Docker容器内的应用直接运行在宿主机的内容，容器是没有自己的内核的，也没有虚拟硬件。")]),s._v(" "),a("p",[s._v("3.每个容器都是相互隔离的，每个容器都有属于自己的文件系统，互不影响。")]),s._v(" "),a("p",[s._v("容器化带来的好处：\n"),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210717124434988.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("h2",{attrs:{id:"_3-docker的基本组成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker的基本组成"}},[s._v("#")]),s._v(" 3.Docker的基本组成")]),s._v(" "),a("p",[a("strong",[s._v("Docker 中有非常重要的三个基本概念，理解了这三个概念，就理解了 Docker 的整个生命周期。")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("**镜像（Image）**Docker镜像就好比是一个模板，可以通过这个模板来创建容器服务，tomcat镜像 ===> run ===> tomcat01容器， 通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）")])]),s._v(" "),a("li",[a("p",[s._v("**容器（Container）**Docker利用容器技术，独立运行一个或者一组应用， 通过镜像来创建的")]),s._v(" "),a("p",[s._v("启动，停止，删除，基本命令！就目前可以把这个容器理解为一个建议的linux系统")])]),s._v(" "),a("li",[a("p",[s._v("**仓库（Repository）**存放镜像的地方，Docker Hub（默认是国外的）阿里云,,,都有容器服务（配置镜像加速！）")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210717120256284.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("h2",{attrs:{id:"_4-阿里云镜像加速"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-阿里云镜像加速"}},[s._v("#")]),s._v(" 4.阿里云镜像加速")]),s._v(" "),a("ol",[a("li",[s._v("登录阿里云服务器，找到"),a("code",[s._v("容器镜像服务")])]),s._v(" "),a("li",[s._v("设置Registry登录密码")]),s._v(" "),a("li",[s._v("找到镜像加速器")]),s._v(" "),a("li",[s._v("配置使用")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/docker"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EOF'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v('"registry-mirrors'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('": ["')]),s._v('https://pi9dpp60.mirror.aliyuncs.com"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("EOF"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n")])])]),a("h2",{attrs:{id:"_5-docker的安装和配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-docker的安装和配置"}},[s._v("#")]),s._v(" 5.Docker的安装和配置")]),s._v(" "),a("p",[s._v("查看系统的内核：")]),s._v(" "),a("p",[s._v("uname -r")]),s._v(" "),a("p",[s._v("系统内核版本为3.10.0")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# uname -r")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),s._v(".0-957.21.3.el7.x86_64\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\n")])])]),a("p",[s._v("查看系统配置")]),s._v(" "),a("p",[s._v("cat /etc/os-release")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/os-release")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS Linux"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VERSION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7 (Core)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"centos"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ID_LIKE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rhel fedora"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("VERSION_ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PRETTY_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS Linux 7 (Core)"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ANSI_COLOR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0;31"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CPE_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cpe:/o:centos:centos:7"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HOME_URL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://www.centos.org/"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BUG_REPORT_URL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://bugs.centos.org/"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CENTOS_MANTISBT_PROJECT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CentOS-7"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CENTOS_MANTISBT_PROJECT_VERSION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDHAT_SUPPORT_PRODUCT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"centos"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDHAT_SUPPORT_PRODUCT_VERSION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7"')]),s._v("\n")])])]),a("p",[s._v("Docker的安装步骤：")]),s._v(" "),a("h3",{attrs:{id:"_1-卸载旧的版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-卸载旧的版本"}},[s._v("#")]),s._v(" （1）卸载旧的版本")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum remove "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-common "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-logrotate "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-engine\n\n")])])]),a("h3",{attrs:{id:"_2-下载需要的安装包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-下载需要的安装包"}},[s._v("#")]),s._v(" （2）下载需要的安装包")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("yum install -y yum-utils\n")])])]),a("h3",{attrs:{id:"_3-设置镜像的仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-设置镜像的仓库"}},[s._v("#")]),s._v(" （3）设置镜像的仓库")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum-config-manager "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    https://download.docker.com/linux/centos/docker-ce.repo  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#国外的地址")]),s._v("\n    \n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置阿里云的Docker镜像仓库")]),s._v("\n\nyum-config-manager "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#国外的地址")]),s._v("\n")])])]),a("h3",{attrs:{id:"_4-更新yum软件包索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-更新yum软件包索引"}},[s._v("#")]),s._v(" （4）更新yum软件包索引")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("yum makecache fast\n")])])]),a("h3",{attrs:{id:"_5-安装docker相关的配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-安装docker相关的配置"}},[s._v("#")]),s._v(" （5）安装docker相关的配置")]),s._v(" "),a("p",[s._v("docker-ce 是社区版，docker-ee 企业版")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io\n")])])]),a("p",[s._v("出现了completed即安装成功。")]),s._v(" "),a("h3",{attrs:{id:"_6-启动docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-启动docker"}},[s._v("#")]),s._v(" （6）启动Docker")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前版本号，是否启动成功")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置开机自启动")]),s._v("\n\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])])]),a("h3",{attrs:{id:"_7-下载helloworld镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-下载helloworld镜像"}},[s._v("#")]),s._v(" （7）下载helloworld镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run hello-world")]),s._v("\nUnable to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" image "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello-world:latest'")]),s._v(" locally  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地没有")]),s._v("\nlatest: Pulling from library/hello-world           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pull一个最新版")]),s._v("\nb8dfde127a29: Pull complete                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pull成功")]),s._v("\nDigest: sha256:df5f5184104426b65967e016ff2ac0bfcd44ad7899ca3bbcf8e44e4461491a9e\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" hello-world:latest\n\nHello from Docker"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("                                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行结果")]),s._v("\nThis message shows that your installation appears to be working correctly.\n\nTo generate this message, Docker took the following steps:\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". The Docker client contacted the Docker daemon.\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". The Docker daemon pulled the "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello-world"')]),s._v(" image from the Docker Hub.\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("amd64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". The Docker daemon created a new container from that image "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" runs the\n    executable that produces the output you are currently reading.\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". The Docker daemon streamed that output to the Docker client, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" sent it\n    to your terminal.\n\nTo try something "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" ambitious, you can run an Ubuntu container with:\n $ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it ubuntu "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n\nShare images, automate workflows, and "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" with a "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v(" Docker ID:\n https://hub.docker.com/\n\nFor "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" examples and ideas, visit:\n https://docs.docker.com/get-started/\n\n")])])]),a("h3",{attrs:{id:"_8-docker卸载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-docker卸载"}},[s._v("#")]),s._v(" （8）Docker卸载")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum remove docker-ce docker-ce-cli containerd.io  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载依赖")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除资源  . /var/lib/docker是docker的默认工作路径")]),s._v("\n")])])]),a("h3",{attrs:{id:"_9-配置阿里云镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-配置阿里云镜像"}},[s._v("#")]),s._v(" （9）配置阿里云镜像")]),s._v(" "),a("p",[s._v("进入阿里云官网，搜索容器镜像服务")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210717125337690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("依次执行官方的这四条命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://axvfsf7e.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])])]),a("h2",{attrs:{id:"_6-docker容器的运行流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-docker容器的运行流程"}},[s._v("#")]),s._v(" 6.Docker容器的运行流程")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210717125820781.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("h2",{attrs:{id:"_7-底层运行原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-底层运行原理"}},[s._v("#")]),s._v(" 7.底层运行原理")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/9c2dd2d195434e6986bf4b521dade393.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX1lhbk1pbmdYaW4=,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("h2",{attrs:{id:"_8-docker整体架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-docker整体架构"}},[s._v("#")]),s._v(" 8.Docker整体架构")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/6c76b121610d4177aeea2636efc76630.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX1lhbk1pbmdYaW4=,size_16,color_FFFFFF,t_70",alt:"[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-p5ZfnhrM-1628378213415)(Docker学习笔记.assets/image-20210803134704395.png)]"}})]),s._v(" "),a("h2",{attrs:{id:"_9-docker常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-docker常用命令"}},[s._v("#")]),s._v(" 9.Docker常用命令")]),s._v(" "),a("h3",{attrs:{id:"_1-基础命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-基础命令"}},[s._v("#")]),s._v(" （1）基础命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看docker的版本信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看docker的系统信息,包括镜像和容器的数量")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" 命令 --help       "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#帮助命令(可查看可选的参数)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" COMMAND --help\n")])])]),a("h3",{attrs:{id:"_2-镜像命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-镜像命令"}},[s._v("#")]),s._v(" （2）镜像命令")]),s._v(" "),a("p",[s._v("1."),a("strong",[s._v("docker images")]),s._v(" 查看本地主机的所有镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY    TAG       IMAGE ID       CREATED         SIZE\nhello-world   latest    bf756fb1ae65   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" months ago   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#解释:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".REPOSITORY  镜像的仓库源\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".TAG  镜像的标签\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".IMAGE ID 镜像的id\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".CREATED 镜像的创建时间\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".SIZE 镜像的大小\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选参数")]),s._v("\n\n-a/--all 列出所有镜像\n\n-q/--quiet 只显示镜像的id\n")])])]),a("p",[s._v("2.**docker search **搜索镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search mysql")]),s._v("\nNAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nmysql                             MySQL is a widely used, open-source relation…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10308")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmariadb                           MariaDB is a community-developed fork of MyS…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3819")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmysql/mysql-server                Optimized MySQL Server Docker images. Create…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("754")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npercona                           Percona Server is a fork of the MySQL relati…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("517")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncentos/mysql-57-centos7           MySQL "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(" SQL database server                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("86")]),s._v("\nmysql/mysql-cluster               Experimental MySQL Cluster Docker images. Cr…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v("\ncenturylink/mysql                 Image containing mysql. Optimized to be link…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可选参数")]),s._v("\n\nSearch the Docker Hub "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" images\n\nOptions:\n  -f, --filter filter   Filter output based on conditions provided\n      --format string   Pretty-print search using a Go template\n      --limit int       Max number of search results "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      --no-trunc        Don't truncate output\n      \n      \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#搜索收藏数大于3000的镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search mysql --filter=STARS=3000")]),s._v("\nNAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nmysql     MySQL is a widely used, open-source relation…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10308")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmariadb   MariaDB is a community-developed fordockerk of MyS…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3819")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("p",[s._v("3."),a("strong",[s._v("docker pull 镜像名[:tag]")]),s._v(" 下载镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull mysql")]),s._v("\nUsing default tag: latest            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果不写tag默认就是latest")]),s._v("\nlatest: Pulling from library/mysql\n6ec7b7d162b2: Pull complete          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#分层下载,docker image的核心-联合文件系统")]),s._v("\nfedd960d3481: Pull complete\n7ab947313861: Pull complete\n64f92f19e638: Pull complete\n3e80b17bff96: Pull complete\n014e976799f9: Pull complete\n59ae84fee1b3: Pull complete\nffe10de703ea: Pull complete\n657af6d90c83: Pull complete\n98bfb480322c: Pull complete\n6aa3859c4789: Pull complete\n1ed875d851ef: Pull complete\nDigest: sha256:78800e6d3f1b230e35275145e657b82c3fb02a27b2d8e76aac2f5e90c1c30873 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#签名")]),s._v("\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mysql:latest\ndocker.io/library/mysql:latest  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载来源的真实地址  #docker pull mysql等价于docker pull docker.io/library/mysql:latest")]),s._v("\n")])])]),a("p",[s._v("指定版本下载")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull mysql:5.7")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(": Pulling from library/mysql\n6ec7b7d162b2: Already exists\nfedd960d3481: Already exists\n7ab947313861: Already exists\n64f92f19e638: Already exists\n3e80b17bff96: Already exists\n014e976799f9: Already exists\n59ae84fee1b3: Already exists\n7d1da2a18e2e: Pull complete\n301a28b700b9: Pull complete\n529dc8dbeaf3: Pull complete\nbc9d021dc13f: Pull complete\nDigest: sha256:c3a567d3e3ad8b05dfce401ed08f0f6bf3f3b64cc17694979d5f2e5d78e10173\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mysql:5.7\ndocker.io/library/mysql:5.7\n")])])]),a("p",[s._v("4."),a("strong",[s._v("docker rmi")]),s._v(" 删除镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.删除指定的镜像id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f  镜像id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.删除多个镜像id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f  镜像id 镜像id 镜像id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.删除全部的镜像id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f  $(docker images -aq)")]),s._v("\n")])])]),a("h3",{attrs:{id:"_3-容器命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-容器命令"}},[s._v("#")]),s._v(" （3）容器命令")]),s._v(" "),a("p",[a("strong",[s._v("说明： 我们有了镜像才可创建容器，linux，下载一个centos镜像来测试学习")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull centos\n")])])]),a("p",[a("strong",[s._v("新建容器并启动")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("可选参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" image\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明")]),s._v("\n\n--name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("“Name”   容器名字    tomcat01    tomcat02    用来区分容器\n-d      后台方式运行\n-it     使用交互方式运行，进入容器查看内容\n-p      指定容器的端口     -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080\n    -p  ip:主机端口：容器端口\n    -p  主机端口：容器端口（常用）\n    -p  容器端口\n    容器端口\n-p      随机指定端口\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试，启动并进入容器")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it centos /bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@74e82b7980e7 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls   # 查看容器内的centos，基础版本，很多命令是不完善的")]),s._v("\nbin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var\ndev  home  lib64  media       opt  root  sbin  sys  usr\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从容器中退回主机")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@77969f5dcbf9 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin   dev  fanfan  lib    lost+found  mnt  proc  run   srv  tmp  var\nboot  etc  home    lib64  media       opt  root  sbin  sys  usr\n")])])]),a("p",[a("strong",[s._v("列出所有的运行的容器")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps 命令")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出当前正在运行的容器")]),s._v("\n\n-a      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出正在运行的容器包括历史容器")]),s._v("\n-n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("?    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示最近创建的容器")]),s._v("\n-q      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只显示当前容器的编号")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -a")]),s._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES\n77969f5dcbf9        centos              "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" minutes ago       Exited "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" minutes ago                       xenodochial_bose\n74e82b7980e7        centos              "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" minutes ago      Exited "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" minutes ago                       silly_cori\na57250395804        bf756fb1ae65        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),s._v("            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" hours ago         Exited "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" hours ago                         elated_nash\n392d674f4f18        bf756fb1ae65        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),s._v("            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" hours ago         Exited "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" hours ago                         distracted_mcnulty\n571d1bc0e8e8        bf756fb1ae65        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),s._v("            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" hours ago        Exited "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" hours ago                        magical_burnell\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -qa")]),s._v("\n77969f5dcbf9\n74e82b7980e7\na57250395804\n392d674f4f18\n571d1bc0e8e8\n")])])]),a("p",[a("strong",[s._v("退出容器")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#exit 停止并退出容器（后台方式运行则仅退出）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Ctrl+P+Q  不停止容器退出")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@bd1b8900c547 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),a("p",[a("strong",[s._v("删除容器")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 容器id                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除指定的容器,不能删除正在运行的容器,强制删除使用 rm -f")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除所有的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除所有的容器")]),s._v("\n")])])]),a("p",[a("strong",[s._v("启动和停止容器")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start 容器id          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器id        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重启容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器id           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止当前运行的容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 容器id           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#强制停止当前容器")]),s._v("\n")])])]),a("h3",{attrs:{id:"_4-常用的其他命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-常用的其他命令"}},[s._v("#")]),s._v(" （4）常用的其他命令")]),s._v(" "),a("p",[a("strong",[s._v("后台启动容器")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令 docker run -d 镜像名")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d centos")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 问题 docker ps， 发现centos停止了")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常见的坑， docker 容器使用后台运行， 就必须要有一个前台进程，docker发现没有应用，就会自动停止")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx， 容器启动后，发现自己没有提供服务，就会立即停止，就是没有程序了")]),s._v("\n")])])]),a("p",[a("strong",[s._v("查看日志")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker logs --help")]),s._v("\n\nUsage:  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" CONTAINER\n\nFetch the logs of a container\n\nOptions:\n      --details        Show extra details provided to logs\n  -f, --follow         Follow log output\n      --since string   Show logs since timestamp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e.g. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("-01-02T13:23:37Z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or relative "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e.g. 42m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v(" minutes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -n, --tail string    Number of lines to show from the end of the logs "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  -t, --timestamps     Show timestamps\n      --until string   Show logs before a timestamp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e.g. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2013")]),s._v("-01-02T13:23:37Z"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" or relative "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e.g. 42m "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42")]),s._v(" minutes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n常用：\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs -tf 容器id\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs --tail number 容器id "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#num为要显示的日志条数")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker容器后台运行，必须要有一个前台的进程，否则会自动停止")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#编写shell脚本循环执行，使得centos容器保持运行状态")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker run -d centos /bin/sh -c "while true;do echo hi;sleep 5;done"')]),s._v("\nc703b5b1911ff84d584390263a35707b6024816e1f46542b61918a6327a570dc\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES\nc703b5b1911f   centos    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh -c \'while t…"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" seconds ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" seconds             pedantic_banach\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker logs -tf --tail 10 c703b5b1911f")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-12-27T03:34:07.255599560Z hi\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-12-27T03:34:12.257641517Z hi\n")])])]),a("p",[a("strong",[s._v("查看容器中进程信息")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令 docker top 容器id")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker top df358bc06b17")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("                 PID                 "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("                C                   STIME               TTY     \nroot                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28498")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28482")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":38               ?      \n")])])]),a("p",[a("strong",[s._v("查看镜像的元数据")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect 容器id")]),s._v("\n")])])]),a("p",[a("strong",[s._v("进入当前正在运行的容器")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我们通常容器使用后台方式运行的， 需要进入容器，修改一些配置")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器id /bin/bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it df358bc06b17 /bin/bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@df358bc06b17 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls       ")]),s._v("\nbin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var\ndev  home  lib64  media       opt  root  sbin  sys  usr\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@df358bc06b17 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("        PID  "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Aug11 pts/0    00:00:00 /bin/bash\nroot        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 01:06 pts/1    00:00:00 /bin/bash\nroot        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 01:06 pts/1    00:00:00 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式二")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 容器id\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec       # 进入容器后开启一个新的终端，可以在里面操作")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker attach     # 进入容器正在执行的终端，不会启动新的进程")]),s._v("\n")])])]),a("p",[a("strong",[s._v("从容器中拷贝文件到主机")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id：容器内路径    目的地主机路径\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp 7af535f807e0:/home/Test.java /home")]),s._v("\n")])])]),a("h2",{attrs:{id:"_10-docker镜像详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-docker镜像详解"}},[s._v("#")]),s._v(" 10.Docker镜像详解")]),s._v(" "),a("h3",{attrs:{id:"_1-什么是镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是镜像"}},[s._v("#")]),s._v(" （1）什么是镜像")]),s._v(" "),a("p",[s._v("镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需要的所有内容，包括代码，运行时（一个程序在运行或者在被执行的依赖）、库，环境变量和配置文件。")]),s._v(" "),a("h3",{attrs:{id:"_2-镜像的加载原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-镜像的加载原理"}},[s._v("#")]),s._v(" （2）镜像的加载原理")]),s._v(" "),a("p",[s._v("Docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统是UnionFS联合文件系统。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210718123220152.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210718123416610.png",alt:"在这里插入图片描述"}})]),s._v(" "),a("h3",{attrs:{id:"_3-分层理解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-分层理解"}},[s._v("#")]),s._v(" （3）分层理解")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210718123636415.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2021071812372978.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2021071812374035.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2h1YW5namhhaQ==,size_16,color_FFFFFF,t_70",alt:"在这里插入图片描述"}})]),s._v(" "),a("h3",{attrs:{id:"_4-提交镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-提交镜像"}},[s._v("#")]),s._v(" （4）提交镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("使用docker commit 命令提交容器成为一个新的版本\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -m"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("“提交的描述信息”  -a"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"作者"')]),s._v(" 容器id 目标镜像名:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TAG"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" \n\n")])])]),a("p",[s._v("由于默认的Tomcat镜像的webapps文件夹中没有任何内容，需要从webapps.dist中拷贝文件到webapps文件夹。下面自行制作镜像：就是从webapps.dist中拷贝文件到webapps文件夹下，并提交该镜像作为一个新的镜像。使得该镜像默认的webapps文件夹下就有文件。具体命令如下：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1.复制文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it tomcat /bin/bash")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd webapps")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat/webapps"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat/webapps"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ../")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp -r webapps.dist/* webapps")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd webapps")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat/webapps"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nROOT  docs  examples  host-manager  manager\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE                 COMMAND        CREATED         STATUS         PORTS                    NAMES\n2a3bf3eaa2e4   tomcat                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" minutes ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" minutes   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp                 competent_torvalds\n7789d4505a00   portainer/portainer   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/portainer"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" hours ago    Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" hours    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8088-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v("/tcp   quirky_sinoussi\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 2a3bf3eaa2e4 /bin/bash")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd webapps")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat/webapps"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nROOT  docs  examples  host-manager  manager\nroot@2a3bf3eaa2e4:/usr/local/tomcat/webapps"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd ../")]),s._v("\nroot@2a3bf3eaa2e4:/usr/local/tomcat"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read escape sequence")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE                 COMMAND        CREATED         STATUS         PORTS                    NAMES\n2a3bf3eaa2e4   tomcat                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" minutes ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" minutes   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/tcp                 competent_torvalds\n7789d4505a00   portainer/portainer   "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/portainer"')]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" hours ago    Up "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" hours    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8088-"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v("/tcp   quirky_sinoussi\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2.提交镜像作为一个新的镜像")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker commit -m="add webapps" -a="Ethan" 2a3bf3eaa2e4 mytomcat:1.0')]),s._v("\nsha256:f189aac861de51087af5bc88a5f1de02d9574e7ee2d163c647dd7503a2d3982b\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY            TAG       IMAGE ID       CREATED         SIZE\nmytomcat              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       f189aac861de   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   653MB\nmysql                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("       f07dfa83b528   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" days ago      448MB\ntomcat                latest    feba8d001e3f   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" days ago     649MB\nnginx                 latest    ae2feff98a0c   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" days ago     133MB\ncentos                latest    300e315adb2f   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" weeks ago     209MB\nportainer/portainer   latest    62771b0b9b09   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" months ago    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(".1MB\nelasticsearch         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.6")]),s._v(".2     f29a1ee41030   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" months ago    791MB\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3.运行容器")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it mytomcat:1.0 /bin/bash")]),s._v("\nroot@1645774d4605:/usr/local/tomcat"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd webapps")]),s._v("\nroot@1645774d4605:/usr/local/tomcat/webapps"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nROOT  docs  examples  host-manager  manager\nwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY            TAG       IMAGE ID       CREATED         SIZE\nmytomcat              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       f189aac861de   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" seconds ago   653MB\nmysql                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v("       f07dfa83b528   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" days ago      448MB\ntomcat                latest    feba8d001e3f   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" days ago     649MB\nnginx                 latest    ae2feff98a0c   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" days ago     133MB\ncentos                latest    300e315adb2f   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" weeks ago     209MB\nportainer/portainer   latest    62771b0b9b09   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" months ago    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("79")]),s._v(".1MB\nelasticsearch         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.6")]),s._v(".2     f29a1ee41030   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(" months ago    791MB\n\n")])])]),a("h2",{attrs:{id:"_11-常用容器部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-常用容器部署"}},[s._v("#")]),s._v(" 11.常用容器部署")]),s._v(" "),a("h3",{attrs:{id:"_1-nginx安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-nginx安装"}},[s._v("#")]),s._v(" （1）Nginx安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search nginx  # 查找")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull nginx    # 下载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name nginx -p 9000:80 nginx   # 启动")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 备注")]),s._v("\n\n-d 后台运行\n--name 给容器命名\n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3334")]),s._v(":80 将宿主机的端口3334映射到该容器的80端口\n")])])]),a("h3",{attrs:{id:"_2-tomcat安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-tomcat安装"}},[s._v("#")]),s._v(" （2）Tomcat安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search tomcat  # 查找")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull tomcat    # 下载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ1608aqb7ntn9Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name tomcat -p 9000:8080 tomcat   # 启动")]),s._v("\n")])])]),a("h3",{attrs:{id:"_3-mysql安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-mysql安装"}},[s._v("#")]),s._v(" （3）MySQL安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#拉取并运行容器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --name mysql-5.7 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" mysql:5.7\n\n-p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 ：映射容器服务的 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" 端口到宿主机的 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" 端口，外部主机可以直接通过 宿主机ip:3306 访问到 MySQL 的服务。\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("：设置 MySQL 服务 默认账号root 用户的密码。\n")])])]),a("h3",{attrs:{id:"_4-端口暴露原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-端口暴露原理"}},[s._v("#")]),s._v(" "),a("strong",[s._v("（4）端口暴露原理")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/fa3ad60d283b47f19c60e23dfc494ac4.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01yX1lhbk1pbmdYaW4=,size_16,color_FFFFFF,t_70",alt:"[外链图片转存中...(img-wrWtj9Ol-1628378213423)]"}})]),s._v(" "),a("h2",{attrs:{id:"_12-容器数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-容器数据卷"}},[s._v("#")]),s._v(" 12.容器数据卷")]),s._v(" "),a("h3",{attrs:{id:"_1-介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-介绍"}},[s._v("#")]),s._v(" （1）介绍")]),s._v(" "),a("p",[s._v("Docker将运用与运行的环境打包形成容器运行， Docker容器产生的数据，如果不通过docker commit生成新的镜像，使得数据做为镜像的一部分保存下来， 那么当容器删除后，数据自然也就没有了。 为了能保存数据在Docker中我们使用卷。|")]),s._v(" "),a("p",[s._v("卷就是目录或文件，存在于一个或多个容器中，由Docker挂载到容器，但卷不属于联合文件系统（Union FileSystem），因此能够绕过联合文件系统提供一些用于持续存储或共享数据的特性:。")]),s._v(" "),a("p",[a("strong",[s._v("卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂载的数据卷。")])]),s._v(" "),a("p",[s._v("数据卷的特点:")]),s._v(" "),a("ul",[a("li",[s._v("数据卷可在容器之间共享或重用数据")]),s._v(" "),a("li",[s._v("卷中的更改可以直接生效")]),s._v(" "),a("li",[s._v("数据卷中的更改不会包含在镜像的更新中")]),s._v(" "),a("li",[s._v("数据卷的生命周期一直持续到没有容器使用它为止")])]),s._v(" "),a("h3",{attrs:{id:"_2-具体使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-具体使用"}},[s._v("#")]),s._v(" （2）具体使用")]),s._v(" "),a("blockquote",[a("p",[s._v("方式一：直接使用命令来挂载 -v")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -it -v 主机目录：容器目录\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it -v /home/ceshi:/home centos /bin/bash")]),s._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200812165141715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2020081216585980.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("h3",{attrs:{id:"_3-常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-常用命令"}},[s._v("#")]),s._v(" （3）常用命令")]),s._v(" "),a("p",[a("strong",[s._v("创建数据卷")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create my-vol\n")])])]),a("p",[a("strong",[s._v("查看所有数据卷")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v(" my-vol\n")])])]),a("p",[a("strong",[s._v("查看指定数据卷的信息")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume inspect my-vol\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mountpoint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/my-vol/_data"')]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-vol"')]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("p",[a("strong",[s._v("删除数据卷")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" my-vol\n")])])]),a("p",[a("strong",[s._v("删除容器之时删除相关的卷")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -v "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),a("p",[s._v("数据卷是被设计用来持久化数据的，它的生命周期独立于容器，Docker 不会在容器被删除后自动删除数据卷，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的数据卷 。如果需要在删除容器的同时移除数据卷。可以在删除容器的时候使用 docker rm -v 这个命令。")]),s._v(" "),a("p",[s._v("无主的数据卷可能会占据很多空间，要清理请使用以下命令")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume prune\n")])])]),a("h3",{attrs:{id:"_4-具名挂载和匿名挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-具名挂载和匿名挂载"}},[s._v("#")]),s._v(" （4）具名挂载和匿名挂载")]),s._v(" "),a("p",[a("strong",[s._v("匿名挂载")])]),s._v(" "),a("p",[s._v("匿名挂载就是在指定数据卷的时候，不指定容器路径对应的主机路径，这样对应映射的主机路径就是默认的路径/var/lib/docker/volumes/中自动生成一个随机命名的文件夹。")]),s._v(" "),a("p",[s._v("如下运行并匿名挂载Nginx容器：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name nginx01 -v /etc/nginx nginx")]),s._v("\nd3a27b969d122d5516cac75e99b17dff7aaaf1e0c042385c6b05990053f1259\n")])])]),a("p",[a("strong",[s._v("具名挂载")])]),s._v(" "),a("p",[s._v("具名挂载，就是指定文件夹名称，区别于指定路径挂载，这里的指定文件夹名称是在Docker指定的默认数据卷路径下的。通过"),a("code",[s._v("docker volume ls")]),s._v("命令可以查看当前数据卷的目录情况。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx")]),s._v("\n4ceaff19e5275dcd3014a8e7a8af618f7f7ce0da18d605c7c41a8653e78bf912\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZwz99sm8v95sckz8bd2c4Z ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume ls")]),s._v("\nDRIVER    VOLUME NAME\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     0cd45ab893fc13971219ac5127f9c0b02491635d76d94183b0261953bdb52d26\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     668a94251e562612880a2fdb03944d67d1acdbbdae6ef7c94bee8685644f2956\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     e605f3dc4bf11ab693972592b55fb6911e5bf2083425fd58869c5f574998a09a\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("     juming-nginx\n")])])]),a("p",[s._v("所有docker容器内的卷，没有指定目录的情况下都是在"),a("code",[s._v("/var/lib/docker/volumes/xxxxx/_data")])]),s._v(" "),a("p",[s._v("我们通过具名挂载可以方便的找到我们的一个卷，大多数情况下使用的是"),a("code",[s._v("具名挂载")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如何确定是具名挂载还是匿名挂载，还是指定路径挂载！")]),s._v("\n-v  容器内路径                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匿名挂载")]),s._v("\n-v  卷名:容器内路径               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 具名挂载")]),s._v("\n-v /主机路径:容器内路径            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定路径挂载")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 -v 容器内容路径 ro rw 改变读写权限")]),s._v("\nro  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("readonly")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只读")]),s._v("\nrw  readwrite   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可读可写")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ro 只要看到ro就说明这个路径只能通过宿主机来操作，容器内容无法操作")]),s._v("\n")])])]),a("h3",{attrs:{id:"_5-容器内数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-容器内数据卷"}},[s._v("#")]),s._v(" （5）容器内数据卷")]),s._v(" "),a("p",[s._v("容器数据卷是指建立数据卷，来同步多个容器间的数据，实现容器间的数据同步。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/2de9be1d5dd54fd9971bf22133500950.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAQ29kZTBjZWFu,size_20,color_FFFFFF,t_70,g_se,x_16",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("多个MySQL实现数据共享")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 3344:3306 -v /etc/mysql/conf.d -v /var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql02 --volumes-from mysql01 mysql:5.7")]),s._v("\n")])])]),a("p",[a("strong",[s._v("结论")])]),s._v(" "),a("p",[s._v("容器之间配置信息的传递， 数据卷容器的声明周期一直持续到没有容器使用为止。")]),s._v(" "),a("p",[s._v("但是一旦你持久化到了本地，这个时候，本地的数据是不会删除的！")]),s._v(" "),a("h2",{attrs:{id:"_13-dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-dockerfile"}},[s._v("#")]),s._v(" 13.DockerFile")]),s._v(" "),a("p",[s._v("dockerFile是用来构建docker镜像的文件！命令参数脚本！")]),s._v(" "),a("p",[s._v("构建步骤")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("编写一个dockerFile文件")])]),s._v(" "),a("li",[a("p",[s._v("docker build 构建成为一个镜像")])]),s._v(" "),a("li",[a("p",[s._v("docker run 运行镜像")])]),s._v(" "),a("li",[a("p",[s._v("docker push 发布镜像（DockerHub、阿里云镜像）")])])]),s._v(" "),a("h3",{attrs:{id:"初始dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始dockerfile"}},[s._v("#")]),s._v(" "),a("strong",[s._v("初始DockerFile")])]),s._v(" "),a("p",[s._v("DockerFile就是用来构建docker镜像的构建文件！命令脚本！先体验一下！")]),s._v(" "),a("p",[s._v("通过这个脚本可以生成镜像，镜像是一层一层的，脚本一个个的命令，每个命令都是一层！")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个dockerfile文件， 名字可以随机")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件的内容 指定（大写） 参数")]),s._v("\n \nFROM centos\n \nVOLUME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume01"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume02"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n \nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"----end----"')]),s._v("\nCMD /bin/bash\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里的每一个命令都是镜像的一层！")]),s._v("\n")])])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813102153118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813103318110.png#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker inspect 容器id\n")])])]),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813103859654.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("测试一下刚才的文件是否同步到主机上了！")]),s._v(" "),a("p",[s._v("这种方式我们未来使用的十分多， 因为我们通常会构建自己的镜像！")]),s._v(" "),a("p",[s._v("假设构建镜像时候没有挂载卷，要手动镜像挂载 -v 卷名:容器内路径！")]),s._v(" "),a("h3",{attrs:{id:"dockerfile的构建过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile的构建过程"}},[s._v("#")]),s._v(" DockerFile的构建过程")]),s._v(" "),a("ol",[a("li",[s._v("每个保留关键字（指令）都是必须大写字母")]),s._v(" "),a("li",[s._v("执行从上到下顺序执行")]),s._v(" "),a("li",[a("code",[s._v("#")]),s._v(" 表示注释")]),s._v(" "),a("li",[s._v("每个指令都会创建提交一个新的镜像层，并提交！")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813142333870.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("dockerFile是面向开发的， 我们以后要发布项目， 做镜像， 就需要编写dockefile文件， 这个文件十分简单！")]),s._v(" "),a("p",[s._v("Docker镜像逐渐成为企业的交互标准，必须要掌握！")]),s._v(" "),a("p",[s._v("步骤：开发，部署， 运维..... 缺一不可！")]),s._v(" "),a("p",[s._v("DockerFile： 构建文件， 定义了一切的步骤，源代码")]),s._v(" "),a("p",[s._v("DockerImages： 通过DockerFile构建生成的镜像， 最终发布和运行的产品！")]),s._v(" "),a("p",[s._v("Docker容器：容器就是镜像运行起来提供服务器")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("FROM            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基础镜像，一切从这里开始构建")]),s._v("\nMAINTAINER      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像是谁写的， 姓名+邮箱")]),s._v("\nRUN             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像构建的时候需要运行的命令")]),s._v("\nADD             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 步骤， tomcat镜像， 这个tomcat压缩包！添加内容")]),s._v("\nWORKDIR         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像的工作目录")]),s._v("\nVOLUME          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载的目录")]),s._v("\nEXPOSE          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保留端口配置")]),s._v("\nCMD             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定这个容器启动的时候要运行的命令，只有最后一个会生效可被替代")]),s._v("\nENTRYPOINT      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定这个容器启动的时候要运行的命令， 可以追加命令")]),s._v("\nONBUILD         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当构建一个被继承DockerFile 这个时候就会运行 ONBUILD 的指令，触发指令")]),s._v("\nCOPY            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 类似ADD, 将我们文件拷贝到镜像中")]),s._v("\nENV             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建的时候设置环境变量！")]),s._v("\n")])])]),a("blockquote",[a("p",[s._v("CMD 和ENTRYPOINT区别")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("CMD         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定这个容器启动的时候要运行的命令，只有最后一个会生效可被替代")]),s._v("\nENTRYPOINT      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定这个容器启动的时候要运行的命令， 可以追加命令")]),s._v("\n")])])]),a("h2",{attrs:{id:"_14-制作并发布tomcat镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-制作并发布tomcat镜像"}},[s._v("#")]),s._v(" 14.制作并发布Tomcat镜像")]),s._v(" "),a("p",[s._v("准备镜像文件 tomcat压缩包，jdk的压缩包！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813164403261.png#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("编写Dockerfile文件，官方命名"),a("code",[s._v("Dockerfile")]),s._v(", build会自动寻找这个文件，就不需要-f指定了！")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ tomcat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat Dockerfile ")]),s._v("\nFROM centos\nMAINTAINER xiaofan"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("594042358")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n \nCOPY readme.txt /usr/local/readme.txt\n \nADD jdk-8u73-linux-x64.tar.gz /usr/local/\nADD apache-tomcat-9.0.37.tar.gz /usr/local/\n \nRUN yum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v("\n \nENV MYPATH /usr/local\nWORKDIR "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\n \nENV JAVA_HOME /usr/local/jdk1.8.0_73\nENV CLASSPATH "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/dt.jar:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/lib/tools.jar\nENV CATALINA_HOME /usr/local/apache-tomcat-9.0.37\nENV CATALINA_BASH /usr/local/apache-tomcat-9.0.37\nENV "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/lib:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/bin\n \nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n \nCMD /usr/local/apache-tomcat-9.0.37/bin/startup.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -F /usr/local/apache-tomcat-9.0.37/bin/logs/catalina.out\n")])])]),a("h3",{attrs:{id:"_1-构建镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-构建镜像"}},[s._v("#")]),s._v(" （1）"),a("strong",[s._v("构建镜像")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -t diytomcat . #记住这个点，记得加上")]),s._v("\n")])])]),a("h3",{attrs:{id:"_2-启动镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动镜像"}},[s._v("#")]),s._v(" （2）"),a("strong",[s._v("启动镜像")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  docker run -d -p 3344:8080 --name xiaofantomcat1 -v /home/xiaofan/build/tomcat/test:/usr/local/apache-tomcat-9.0.37/webapps/test -v /home/xiaofan/build/tomcat/tomcatlogs/:/usr/local/apache-tomcat-9.0.37/logs diytomcat")]),s._v("\n")])])]),a("h3",{attrs:{id:"_3-发布镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-发布镜像"}},[s._v("#")]),s._v(" （3）"),a("strong",[s._v("发布")]),s._v("镜像")]),s._v(" "),a("blockquote",[a("p",[s._v("先注册一个Docker Hub账号")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813182851607.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("登录账号")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200813183151439.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZhbmppYW5oYWk=,size_16,color_FFFFFF,t_70#pic_center",alt:"在这里插入图片描述"}})]),s._v(" "),a("p",[s._v("提交镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# push到我们的服务器上")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@iZ2zeg4ytp0whqtmxbsqiiZ ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker push diytomcat")]),s._v("\nThe push refers to repository "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/library/diytomcat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n2eaca873a720: Preparing \n1b38cc4085a8: Preparing \n088ebb58d264: Preparing \nc06785a2723d: Preparing \n291f6e44771a: Preparing \ndenied: requested access to the resource is denied  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拒绝")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# push镜像的问题？")]),s._v("\nThe push refers to repository "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("docker.io/1314520007/diytomcat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nAn image does not exist locally with the tag: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1314520007")]),s._v("/diytomcat\n \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解决，增加一个tag")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag diytomcat "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1314520007")]),s._v("/tomcat:1.0\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);